
<div class="p-3">

  <div class="d-flex">
    <div class="p-2 bd-highlight"><h2>Reports</h2></div>
    <div class="p-2" style="margin-left: auto">

    </div>
  </div>
<div class=" d-flex row  p-2">
  <div class="col-8 d-flex"  >
    <p style="font-weight: bold"> Financial Year :</p>

    <mat-select placeholder="Financial Year" class="ms-2" value="2023" (selectionChange)="financialYear($event)" >
      <mat-option value="2022">
        2022-23
      </mat-option>
      <mat-option value="2023">
        2023-24
      </mat-option>
    </mat-select>
  </div>
  <div class="col-4">
    <input type="text" placeholder="Search" style="width: 100%"  (input)="search($event)">
  </div>


</div>
  <mat-divider></mat-divider>
  <mat-accordion  *ngFor="let report of report">
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-description>
          <div class="row " style="width: 100%;font-weight: 500;">
            <div class="col headers"> <span class="head"> Budget ID</span> <br>{{report.budgetCode}}</div>
            <div class="col headers"> <span class="head">Budget Desc</span> <br>{{report.budgetDesc}}</div>
            <div class="col headers"> <span class="head">Budget Amount</span> <br>{{report.budgetAmount}}</div>
            <div class="col headers"><span class="head">Capex Amount</span> <br>{{report.capexAmount}}</div>
            <div class="col headers"><span class="head">IO Amount </span> <br>{{report.ioAmount}}</div>
            <div class="col headers"><span class="head">GRN Amount </span> <br>{{report.grnAmount}}</div>
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <mat-divider></mat-divider>
      <br>
      <table class="table">
        <thead>
        <tr>
          <th scope="col"  style="white-space: nowrap">
            <div class="d-flex ">
            Capex ID
          <span style="float: right;" class="me-2 ms-2" *ngIf="report.showIO">
            <button mat-stroked-button color="primary" (click)="ioExpand(report)">
          <mat-icon>last_page</mat-icon> Internal Orders
        </button>
          </span>
            <span style="float: right" class="me-2 ms-2" *ngIf="!report.showIO">
            <button mat-stroked-button color="primary" (click)="ioExpand(report)">
          <mat-icon>first_page</mat-icon> Capex Details
        </button>
          </span>
            </div>
          </th>
          <th scope="col" *ngIf="report.showIO">Budgets Used</th>
          <th scope="col" *ngIf="report.showIO" style="width: 20%">Capex Desc</th>
          <th scope="col" *ngIf="report.showIO">Utilised Amount</th>
          <th scope="col" *ngIf="report.showIO">Capex Amount</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let cpx of report.cpxData">
          <td>{{cpx.cpxCode}}</td>
          <td *ngIf="report.showIO">{{cpx.usedBudgets}}</td>
          <td *ngIf="report.showIO">{{cpx.cpxDesc}}</td>
          <td *ngIf="report.showIO">{{cpx.utilisedAmt}}</td>
          <td *ngIf="report.showIO" >{{cpx.cpxAmt}}</td>
          <td *ngIf="!report.showIO">
            <p  *ngIf="cpx.ioData.length ==0">No Internal Orders Created</p>
            <table class="table" *ngIf="cpx.ioData.length !==0">
                        <th scope="col">Internal order</th>
                        <th scope="col">IO Budget</th>
                        <th scope="col">PO Number</th>
                        <th scope="col">PO Value</th>
                        <th scope="col">GRN Number</th>
                        <th scope="col">GRN Amount</th>
              <tr *ngFor="let repo of cpx.ioData">

                <td>{{repo.internalOrder}}</td>
                <td>{{repo.ioBudget}}</td>
                <td>{{repo.poNumber}}</td>
                <td>{{repo.poValue}}</td>
                <td>{{repo.grnNumber}}</td>
                <td>{{repo.grnAmount}}</td>
              </tr>
            </table>
          </td>

        </tr>

        </tbody>
      </table>
    </mat-expansion-panel>
    <br>
  </mat-accordion>
  <div class="d-flex justify-content-center" *ngIf="report.length ===0">
    <h2>No Data Found</h2>
  </div>
</div>


